use ensnano_design::Curve;
use ensnano_design::*;
use std::sync::Arc;

use ultraviolet::{Rotor3, Vec3};

fn main() {
    let curve = CurveDescriptor2D::Ellipse {
        semi_minor_axis: 1f64.into(),
        semi_major_axis: 2f64.into(),
    };

    let mut design = Design::new();
    let mut helices = design.helices.make_mut();
    let mut helix_ids = Vec::new();
    let mut helices_length = Vec::new();

    for cycle in CYCLES {
        let interpolators = cycle
            .iter()
            .map(|i| InterpolationDescriptor::PointsValues {
                points: POINTS.to_vec(),
                values: VALUES[*i].to_vec(),
            })
            .collect();
        let desc = InterpolatedCurveDescriptor {
            curve: curve.clone(),
            curve_scale_factor: 4.,
            half_turns_count: 5,
            revolution_radius: 20.,
            interpolation: interpolators,
        };
        let mut cache = Default::default();
        let curve = InstanciatedCurveDescriptor::try_instanciate(Arc::new(
            CurveDescriptor::InterpolatedCurve(desc.clone()),
        ))
        .unwrap()
        .make_curve(&Parameters::GEARY_2014_DNA, &mut cache);
        let mut helix = Helix::new(Vec3::zero(), Rotor3::identity());
        helix.curve = Some(Arc::new(
            ensnano_design::CurveDescriptor::InterpolatedCurve(desc),
        ));
        helix_ids.push(helices.push_helix(helix));
        helices_length.push(curve.nb_points());
    }
    drop(helices);
    design.get_updated_grid_data();

    for (len_idx, h_id) in helix_ids.iter().enumerate() {
        let len = helices_length[len_idx];
        let forward_strand = Strand {
            cyclic: false,
            junctions: vec![],
            sequence: None,
            color: 0xeb4034,
            domains: vec![Domain::HelixDomain(HelixInterval {
                helix: *h_id,
                start: 0,
                end: len as isize,
                forward: true,
                sequence: None,
            })],
            name: None,
        };
        let backward_strand = Strand {
            cyclic: false,
            junctions: vec![],
            sequence: None,
            color: 0xeb4034,
            domains: vec![Domain::HelixDomain(HelixInterval {
                helix: *h_id,
                start: 0,
                end: len as isize,
                forward: false,
                sequence: None,
            })],
            name: None,
        };
        design.strands.push(forward_strand);
        design.strands.push(backward_strand);
    }

    use std::io::Write;
    let json_content = serde_json::to_string_pretty(&design).ok().unwrap();
    let mut f = std::fs::File::create("five_turn.ens").ok().unwrap();
    f.write_all(json_content.as_bytes());

    /*
    while !found {
        let big_radius = (lower_bound_radius + upper_bound_raidus) / 2.;
        let desc = TwistedTorusDescriptor {
            big_radius: big_radius.into(),
            curve: curve.clone(),
            helix_index_shift_per_turn: -5,
            number_of_helix_per_section: 18,
            initial_index_shift: 0,
            initial_curvilinear_abscissa: 0f64.into(),
            symetry_per_turn: 3,
        };
        println!("upper bound {upper_bound_raidus}");
        println!("lower bound {lower_bound_radius}");
        println!("radius {big_radius}");
        let mut cache = Default::default();
        let curve = InstanciatedCurveDescriptor::try_instanciate(Arc::new(
            CurveDescriptor::TwistedTorus(desc),
        ))
        .unwrap()
        .make_curve(&parameters, &mut cache);

        let nb_points = curve.nb_points();

        println!("nb point {nb_points}");
        println!("objective {LEN_SCAFFOLD}");

        if nb_points < LEN_SCAFFOLD {
            lower_bound_radius = big_radius;
        } else if nb_points > LEN_SCAFFOLD {
            upper_bound_raidus = big_radius;
        } else {
            found = true
        }
    }
        */
}

const POINTS: &[f64] = &[
    0.0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1, 0.11, 0.12, 0.13, 0.14, 0.15,
    0.16, 0.17, 0.18, 0.19, 0.2, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29, 0.3, 0.31,
    0.32, 0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4, 0.41, 0.42, 0.43, 0.44, 0.45, 0.46, 0.47,
    0.48, 0.49, 0.5, 0.51, 0.52, 0.53, 0.54, 0.55, 0.56, 0.57, 0.58, 0.59, 0.6, 0.61, 0.62, 0.63,
    0.64, 0.65, 0.66, 0.67, 0.68, 0.69, 0.7, 0.71, 0.72, 0.73, 0.74, 0.75, 0.76, 0.77, 0.78, 0.79,
    0.8, 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87, 0.88, 0.89, 0.9, 0.91, 0.92, 0.93, 0.94, 0.95,
    0.96, 0.97, 0.98, 0.99, 1.0,
];

const VALUES: &[&[f64]] = &[
    &[
        0.0,
        -0.009260611054416796,
        -0.01839611921446733,
        -0.02732925467938579,
        -0.03600257052890063,
        -0.04437230496350236,
        -0.05243931653587959,
        -0.060234853942009316,
        -0.06777509568634203,
        -0.07507413752349748,
        -0.08215892226869922,
        -0.08904239954164668,
        -0.09571534723103982,
        -0.10214855901976135,
        -0.1083180717437594,
        -0.11418157786757681,
        -0.119689627213544,
        -0.12478830463450465,
        -0.1294456495294223,
        -0.13363921919567037,
        -0.13735576143864342,
        -0.14059466468971826,
        -0.14337604504269522,
        -0.14572227324451223,
        -0.14766781708365864,
        -0.1492718029315648,
        -0.15063940479239982,
        -0.15189146088294142,
        -0.1531386617274524,
        -0.15448107173129189,
        -0.15600466577507913,
        -0.15775949841445275,
        -0.15977842544522766,
        -0.16208275955699467,
        -0.1646592920193009,
        -0.16748324201144132,
        -0.17053935329253303,
        -0.1737942826639345,
        -0.1772117459254772,
        -0.18077325455212634,
        -0.1844583513882491,
        -0.188255886182436,
        -0.1921437742645468,
        -0.1961341661327463,
        -0.2002148416523103,
        -0.20437688381602476,
        -0.20861278575818504,
        -0.21292377565228648,
        -0.21728907392119898,
        -0.2216788416292123,
        -0.2260812832363598,
        -0.23048521279022813,
        -0.23485603132015648,
        -0.23916574358018888,
        -0.2433997970696465,
        -0.2475449108799529,
        -0.25157269614109334,
        -0.25545229646634454,
        -0.259172885742139,
        -0.2627311091398064,
        -0.2660901510065949,
        -0.2692239390923762,
        -0.27213192187424284,
        -0.2747917274141291,
        -0.27716767585230667,
        -0.27924676258694875,
        -0.2810451368885192,
        -0.2825504589530563,
        -0.28377902790403936,
        -0.2847820323213813,
        -0.2856455691048741,
        -0.286478839376637,
        -0.2873569064577686,
        -0.28841154574835703,
        -0.2896101671777993,
        -0.2910012804473172,
        -0.2926054893828255,
        -0.29447362703008506,
        -0.2966837574273962,
        -0.29925165175892326,
        -0.3022032180902965,
        -0.30553845802179086,
        -0.3092365755877213,
        -0.31326308635928624,
        -0.3175630500298843,
        -0.3221133951167933,
        -0.32688700186278247,
        -0.33182507562694924,
        -0.33689469955404777,
        -0.3420601322319722,
        -0.3473234908595435,
        -0.35263243718552345,
        -0.3579745635745365,
        -0.36335124989884454,
        -0.36877163619006154,
        -0.37421223483967525,
        -0.379677878840225,
        -0.38518821590047325,
        -0.3907352664003857,
        -0.39630792568377976,
        -0.4019298804955803,
    ],
    &[
        0.09807011950441973,
        0.09238571139441089,
        0.08664733380117652,
        0.08081417695363569,
        0.07484465236214737,
        0.0687271709713241,
        0.062411209455402676,
        0.05585284414496884,
        0.049039412895577686,
        0.04196363914811673,
        0.03463532719438217,
        0.027115192945243206,
        0.019495327108435254,
        0.01188461974163157,
        0.0044089932683943475,
        -0.00281831111287888,
        -0.009716504248860098,
        -0.016240910592822275,
        -0.02238053296826767,
        -0.028142333246567522,
        -0.03353393220162434,
        -0.03857018920552105,
        -0.04328501992475794,
        -0.047731729513640256,
        -0.051984437054307,
        -0.05613808548094988,
        -0.06027857204267208,
        -0.06445781826896031,
        -0.06871994847053674,
        -0.07310208606157804,
        -0.07760380955771232,
        -0.08222152639827746,
        -0.08696332375095232,
        -0.0917996772919781,
        -0.09670323826401413,
        -0.10168346414756013,
        -0.10668556060533721,
        -0.1116658781377941,
        -0.1166513346120944,
        -0.12157427288144365,
        -0.12643653293395077,
        -0.13129061613663762,
        -0.13609663100784025,
        -0.1408796834997496,
        -0.14570966265586732,
        -0.1505593362812777,
        -0.1554240979611915,
        -0.1603684771353075,
        -0.165360035335161,
        -0.17033777780822365,
        -0.17533222533060558,
        -0.1803205641104899,
        -0.1852276668294046,
        -0.19001249106414092,
        -0.19469877385637094,
        -0.19922810870330876,
        -0.20353424602714063,
        -0.20760466991349089,
        -0.21146218165575997,
        -0.21502984906685052,
        -0.21825788137014845,
        -0.22117103720636574,
        -0.2237758253296892,
        -0.22599026712182832,
        -0.22783997946951046,
        -0.22941890202185955,
        -0.23077719362225624,
        -0.23192477518173552,
        -0.2329656715975248,
        -0.23392553984043932,
        -0.23483366502750444,
        -0.23572525614313575,
        -0.23667229703699402,
        -0.2377474242311321,
        -0.23899382039004247,
        -0.24055802679769175,
        -0.2424518114501337,
        -0.24461382299207704,
        -0.24709036314753122,
        -0.24991184822355347,
        -0.2529823539375025,
        -0.2562946648274728,
        -0.25988133322150964,
        -0.2636642899435818,
        -0.26759206145329284,
        -0.2716893590384516,
        -0.2759274089507817,
        -0.2802381559503751,
        -0.28461428456563526,
        -0.2890667457271608,
        -0.29355763114642,
        -0.29804096396334645,
        -0.30252321722099934,
        -0.3070161016744437,
        -0.3114729695563612,
        -0.3158732832612183,
        -0.3202480392590493,
        -0.32458594802124235,
        -0.32883950882468516,
        -0.33303963702119715,
        -0.3371897626129583,
    ],
    &[
        0.1628102373870417,
        0.1587682757161082,
        0.1548080090243289,
        0.15093416365202963,
        0.14718821617587963,
        0.14356257783417223,
        0.1400629404095144,
        0.1367324881985644,
        0.13357786893926224,
        0.1306124276276862,
        0.12787761646084464,
        0.12537780042381066,
        0.12310255672796921,
        0.12103526290269032,
        0.11911269044279693,
        0.11723987068468728,
        0.11531142435385992,
        0.11320619677414587,
        0.11080698239151568,
        0.10803002220497493,
        0.1048207553958452,
        0.10113604005981279,
        0.09694139372330987,
        0.09221284438284162,
        0.08693308588902654,
        0.08108929574700253,
        0.0746820085319538,
        0.0677258563012719,
        0.06023956069215304,
        0.05224435667102376,
        0.04376895678875656,
        0.034860205315858754,
        0.02559434101090108,
        0.01608325566213224,
        0.0064582248908353615,
        -0.0031293567313531484,
        -0.012512391068532415,
        -0.021568221139530667,
        -0.030231056493728696,
        -0.03845552506474155,
        -0.04625394724818822,
        -0.05368914422253428,
        -0.060819819567994905,
        -0.06770445460649581,
        -0.0744239405673708,
        -0.08104147265881499,
        -0.08758936573056399,
        -0.09410466678641327,
        -0.10060588154793512,
        -0.10707434237200136,
        -0.113482838314304,
        -0.11980019702337665,
        -0.1259723479843409,
        -0.13194260551227213,
        -0.1376622913837165,
        -0.14308536214422016,
        -0.14815992679142437,
        -0.15285006475951846,
        -0.15712578087411977,
        -0.1609647002652356,
        -0.16435577245798977,
        -0.16730938745740181,
        -0.16985377860502898,
        -0.17201646052463393,
        -0.1738286618190425,
        -0.17531887970040963,
        -0.17652779837642346,
        -0.17753247607438832,
        -0.17844513061493342,
        -0.17939074662230928,
        -0.18047305893721785,
        -0.18176450725203294,
        -0.18330988745985607,
        -0.18513144485547658,
        -0.18722950690957596,
        -0.18959840008636186,
        -0.19222165223085627,
        -0.19507774214563042,
        -0.1981508705756691,
        -0.201419425957719,
        -0.20486479044890293,
        -0.20847073920306447,
        -0.21221862612220116,
        -0.21609155106037914,
        -0.22008255945763594,
        -0.2241639988205582,
        -0.22831622029150475,
        -0.23252998159604757,
        -0.23678529821080066,
        -0.241059934568598,
        -0.24533856502402449,
        -0.24961152428299993,
        -0.2538632551182084,
        -0.2580733433101781,
        -0.2622272105327615,
        -0.266315688027134,
        -0.27032507905118563,
        -0.2742311116841692,
        -0.27802441603212813,
        -0.28168960096728274,
        -0.2851978094918558,
    ],
    &[
        0.21480219050814423,
        0.2114698407211923,
        0.2083246121971027,
        0.20539821256317922,
        0.20271277644294164,
        0.20027808403999164,
        0.19811594691711745,
        0.1962367753997223,
        0.19462793938612546,
        0.19327154401276814,
        0.1921355132183069,
        0.19116335976213897,
        0.19026133561496028,
        0.18932399522055998,
        0.18823828250422403,
        0.18693095142273972,
        0.1853633589167021,
        0.18351580387049257,
        0.18135874463922275,
        0.17885212848459364,
        0.17596330298961058,
        0.17266939938993844,
        0.16896946715077368,
        0.1648830818275221,
        0.16042359904778697,
        0.1556259859516802,
        0.15052510780638498,
        0.14515632955655863,
        0.1395531974710503,
        0.1337603348849679,
        0.12781575263078065,
        0.12174709627069061,
        0.1155964213781592,
        0.10940442240963702,
        0.10318995132663807,
        0.09696737067179398,
        0.09074951167954443,
        0.08451525417310438,
        0.0782204372085759,
        0.07183361073481025,
        0.06528031345153527,
        0.05849714161075393,
        0.05141217003850383,
        0.043942178341609815,
        0.036037837361157184,
        0.02767441287845059,
        0.01884578489221915,
        0.009621423633849773,
        0.00013437686785100665,
        -0.009459370808005758,
        -0.018971091788835565,
        -0.02820543017975528,
        -0.037008766968572894,
        -0.04527270055257777,
        -0.05292659816319747,
        -0.05993187231455928,
        -0.06628019660613389,
        -0.07199046610308817,
        -0.07709380893394571,
        -0.08161829713255295,
        -0.08559679171205177,
        -0.08907376876053866,
        -0.09210215022253405,
        -0.0947490196955115,
        -0.09711352630657209,
        -0.09932557746764938,
        -0.10151879768312497,
        -0.10381266258425885,
        -0.10630700076579648,
        -0.1090648393595113,
        -0.11210540209114386,
        -0.11541168775830601,
        -0.11895013709011014,
        -0.12267475535850296,
        -0.12653168757661618,
        -0.13050144537236114,
        -0.13454396325543452,
        -0.1386273277750093,
        -0.14279052426818678,
        -0.14699001854269358,
        -0.15123443542667567,
        -0.15555491333285731,
        -0.15992525951103284,
        -0.16435767100793,
        -0.1688761759742987,
        -0.17340587975243413,
        -0.1780133875041734,
        -0.18266859535479174,
        -0.18730301477742173,
        -0.19194878659440526,
        -0.19660148400887564,
        -0.20120250064757048,
        -0.20572583826917754,
        -0.21017676543693647,
        -0.2145587494447995,
        -0.21880873613791305,
        -0.22288970183746992,
        -0.2268453317790791,
        -0.2306046955884515,
        -0.2341039275474409,
        -0.23740065061202498,
    ],
    &[
        0.262599349387975,
        0.25956247608842453,
        0.2568575068281534,
        0.2544537758040018,
        0.2523206485014768,
        0.25058504293374895,
        0.24913988274631127,
        0.2479234728122236,
        0.24683802375107963,
        0.2458631321876444,
        0.2449367516335937,
        0.2439702163232028,
        0.24299783045688414,
        0.2419492778024147,
        0.24073748817437698,
        0.23936484867513802,
        0.23773388794142022,
        0.23579485270452835,
        0.23345653633536606,
        0.23082304829195763,
        0.22789546494873636,
        0.2246413780781811,
        0.22111860863373994,
        0.2173848071946068,
        0.21341359258416454,
        0.20921488747263559,
        0.20488545498166413,
        0.20040232642865474,
        0.19575408361548358,
        0.19104107649866772,
        0.18627520545699489,
        0.1814415439118867,
        0.1765760001666004,
        0.1717400914405362,
        0.16694974739869287,
        0.16217617900653955,
        0.15745954292107164,
        0.15284610904803062,
        0.14823446388508973,
        0.1436920505509557,
        0.13917508882633353,
        0.1346474651501718,
        0.13014349177342324,
        0.12561412734361851,
        0.12106896041663001,
        0.11656339391673318,
        0.11207528353084421,
        0.10767371453389246,
        0.10341463980497319,
        0.09932705210615288,
        0.0954597356782141,
        0.09184145440771925,
        0.08846838530631955,
        0.08530919835273108,
        0.08231758285866726,
        0.0794113403375747,
        0.07647403342375536,
        0.07339108843290608,
        0.07005332528639957,
        0.06635831223601654,
        0.062231363460086876,
        0.057626196573320757,
        0.05250323915227072,
        0.046821146485031044,
        0.04054297656729219,
        0.033646499507614794,
        0.026135120540979984,
        0.018054009692398995,
        0.00950551210349098,
        0.000646929305230164,
        -0.008330877490290423,
        -0.017234008489010536,
        -0.02589803069551232,
        -0.0342100217538456,
        -0.04210762165066208,
        -0.04959014791971958,
        -0.05668959715931817,
        -0.0634450550672594,
        -0.06992630372064647,
        -0.07618985923817873,
        -0.08229615692764956,
        -0.08830331374534942,
        -0.09425227831002689,
        -0.10016180050642907,
        -0.10605994424616176,
        -0.11194095705907191,
        -0.11780421950690662,
        -0.12364084037232784,
        -0.12943003594138097,
        -0.13515534814111263,
        -0.1408025455639641,
        -0.14634609783308178,
        -0.15176206028036723,
        -0.15702638989518938,
        -0.1621127746941228,
        -0.16698853881507558,
        -0.17161732911755337,
        -0.17596540010655637,
        -0.1799941962706127,
        -0.18367071916845173,
        -0.1869777706498651,
    ],
    &[
        0.3130222293501349,
        0.3100974154150906,
        0.30755711479972925,
        0.30535391487535846,
        0.30347292577359486,
        0.3018221699419684,
        0.3004396427409105,
        0.2992409759065365,
        0.2982580435692298,
        0.2973762292359256,
        0.29650514143587703,
        0.29553090160862666,
        0.2943711872444241,
        0.2929677620632325,
        0.29129190141999173,
        0.28933291416735235,
        0.28708622633656183,
        0.28455996668295375,
        0.28178009395377235,
        0.2787682303484728,
        0.27554470848368434,
        0.2721339482375753,
        0.2685556179129478,
        0.2648259049710714,
        0.2609615302097671,
        0.25697888702691996,
        0.25289356347434144,
        0.24872366612376426,
        0.24448289124618078,
        0.24018622725811495,
        0.2358510359232533,
        0.23150295091781228,
        0.2271623336305524,
        0.22284140478139128,
        0.2185591669838123,
        0.2143426209574822,
        0.21021334958541943,
        0.2061765729620752,
        0.20224048380915857,
        0.19842798821472657,
        0.19474217385864862,
        0.19119681738405678,
        0.18779812655646178,
        0.18456148846374867,
        0.1815203710706006,
        0.1786944393897616,
        0.17610147436611284,
        0.17378011859652212,
        0.17174703170436634,
        0.1700002714540413,
        0.1685248437713125,
        0.16728244338840728,
        0.16620481199840717,
        0.16520147441503202,
        0.16415155501902504,
        0.16293119715383536,
        0.16143220180629878,
        0.1595811313088994,
        0.15733815316665775,
        0.15467643736845949,
        0.15157101846031287,
        0.14800068515498244,
        0.14395843066900402,
        0.13945112210986663,
        0.1345031290387365,
        0.12915009424122004,
        0.12344083025436953,
        0.11743664137874503,
        0.11119438303579687,
        0.10476661915641969,
        0.09819976635714107,
        0.09152835464769139,
        0.084770617398141,
        0.07791974231778787,
        0.07095159991191048,
        0.06383625729341634,
        0.05652999261637456,
        0.04897344759167305,
        0.0411117169812773,
        0.032916187051181836,
        0.024370789909171322,
        0.015481628559123788,
        0.006307747006788509,
        -0.0030419232898323476,
        -0.012449487234180144,
        -0.021793687397002586,
        -0.030952246776763954,
        -0.039840813139676454,
        -0.04841648585237042,
        -0.05665673664443197,
        -0.06454677373006185,
        -0.07207940616450158,
        -0.0792514161018939,
        -0.08605815226871019,
        -0.09248024532476376,
        -0.09849003044811533,
        -0.1040682723027239,
        -0.10919570336510787,
        -0.11385090682080083,
        -0.1180238742743947,
        -0.12172479307835982,
    ],
    &[
        0.37827520692164024,
        0.3750307636333379,
        0.3722241537444062,
        0.36982691836908116,
        0.3677811374354499,
        0.36599898289047217,
        0.36437449061677785,
        0.3628007987184542,
        0.3611734557779183,
        0.35940637774525697,
        0.3574473584023463,
        0.35526973550088536,
        0.3528483350740056,
        0.3501757727307176,
        0.34727642095287675,
        0.34416802373890987,
        0.34085630761571317,
        0.3373672857777142,
        0.3337434506196075,
        0.329991255594534,
        0.32612297128092893,
        0.3221710819327488,
        0.3181486085009492,
        0.3140469212682703,
        0.3098741222953381,
        0.3056479203978156,
        0.30136698459229566,
        0.297018676047501,
        0.29262397888484365,
        0.2882060769616313,
        0.2837763935499418,
        0.2793407792007367,
        0.27491889210689463,
        0.2705513656274048,
        0.26626914881193636,
        0.2620761700190175,
        0.25798975414435227,
        0.2540485698261003,
        0.25029852948443265,
        0.24674690681014486,
        0.243389043567876,
        0.24027524296060637,
        0.23744536173959416,
        0.23489891126194667,
        0.23261913378043814,
        0.23064671471242268,
        0.22900042228011758,
        0.22763813379846692,
        0.22651105183143946,
        0.22556229973777783,
        0.22474980779608936,
        0.22386519267483707,
        0.22298565544600152,
        0.22184218816654008,
        0.22072209954248012,
        0.2193553353292855,
        0.2178244509653132,
        0.21596197616441806,
        0.2137561944239092,
        0.21119820545640003,
        0.20827382237308736,
        0.20496959245638494,
        0.20131743839050412,
        0.19735989499816933,
        0.1931474848693626,
        0.18869251113410077,
        0.1840170843901118,
        0.17917918057001364,
        0.17422501228025974,
        0.16919515465677207,
        0.16409520690915705,
        0.15896401784370792,
        0.1538319007020417,
        0.1487294618218301,
        0.14363012035880743,
        0.1385311442517148,
        0.1334384007159095,
        0.1283467064337887,
        0.12320998233536362,
        0.11801963712166995,
        0.11278975034455005,
        0.10750556601457664,
        0.10215212263513049,
        0.09676094349421799,
        0.09133674706457706,
        0.08585600978677499,
        0.08033014629451198,
        0.07476624239435653,
        0.06913305012933062,
        0.06342654567101294,
        0.0576659455906357,
        0.051849882802775325,
        0.04599284650519253,
        0.040143601974009034,
        0.03433203134042949,
        0.028557928450634634,
        0.022822392496078796,
        0.01711917019092228,
        0.011424167244869877,
        0.005717864110526904,
        0.0,
    ],
    &[
        0.5000000000000001,
        0.4942821358894733,
        0.48857583275513006,
        0.48288082980907776,
        0.47717760750392113,
        0.47144207154936557,
        0.46566796865957055,
        0.4598563980259911,
        0.4540071534948074,
        0.4481501171972246,
        0.4423340544093644,
        0.436573454328987,
        0.4308669498706693,
        0.4252337576056434,
        0.41966985370548787,
        0.4141439902132248,
        0.4086632529354228,
        0.4032390565057821,
        0.3978478773648694,
        0.3924944339854236,
        0.3872102496554496,
        0.38198036287833004,
        0.37679001766463627,
        0.371653293566209,
        0.36656159928409676,
        0.36146885574827764,
        0.3563698796411972,
        0.35127053817816845,
        0.3461680992979586,
        0.34103598215629216,
        0.3359047930908431,
        0.33080484534322735,
        0.32577498771974045,
        0.32082081942998636,
        0.3159829156098885,
        0.3113074888658993,
        0.3068525151306372,
        0.30264010500183075,
        0.29868256160949586,
        0.29503040754361504,
        0.2917261776269124,
        0.28880179454359967,
        0.28624380557609086,
        0.2840380238355821,
        0.28217554903468683,
        0.2806446646707143,
        0.2792779004575198,
        0.27815781183345994,
        0.2770143445540027,
        0.2761348073251473,
        0.2752501922039355,
        0.2744377002622042,
        0.2734889481685654,
        0.2723618662015332,
        0.2709995777198821,
        0.26935328528757746,
        0.2673808662195616,
        0.2651010887380535,
        0.2625546382604057,
        0.2597247570393936,
        0.2566109564321241,
        0.2532530931898551,
        0.24970147051556726,
        0.24595143017389978,
        0.2420102458556477,
        0.2379238299809826,
        0.23373085118806375,
        0.229448634372595,
        0.2250811078931054,
        0.2206592207992633,
        0.21622360645005811,
        0.21179392303836836,
        0.20737602111515605,
        0.2029813239524991,
        0.19863301540770342,
        0.1943520796021845,
        0.1901258777046633,
        0.18595307873172898,
        0.18185139149905039,
        0.17782891806725107,
        0.17387702871907101,
        0.1700087444054656,
        0.1662565493803925,
        0.1626327142222859,
        0.15914369238428736,
        0.15583197626109035,
        0.15272357904712347,
        0.14982422726928227,
        0.1471516649259943,
        0.14473026449911475,
        0.14255264159765385,
        0.14059362225474273,
        0.13882654422208138,
        0.1371992012815453,
        0.13562550938322226,
        0.13400101710952797,
        0.13221886256455037,
        0.13017308163091867,
        0.12777584625559424,
        0.12496923636666214,
        0.12172479307835982,
    ],
    &[
        0.6217247930783597,
        0.6180238742743945,
        0.6138509068208007,
        0.6091957033651078,
        0.6040682723027238,
        0.5984900304481153,
        0.5924802453247638,
        0.5860581522687099,
        0.5792514161018938,
        0.5720794061645018,
        0.5645467737300612,
        0.5566567366444322,
        0.5484164858523699,
        0.5398408131396769,
        0.5309522467767641,
        0.5217936873970036,
        0.5124494872341803,
        0.5030419232898327,
        0.4936922529932113,
        0.48451837144087556,
        0.47562921009082837,
        0.46708381294881773,
        0.4588882830187225,
        0.4510265524083248,
        0.44347000738363146,
        0.4361637427065739,
        0.4290484000880971,
        0.42208025768220975,
        0.41522938260185904,
        0.40847164535230834,
        0.4018002336428587,
        0.39523338084358045,
        0.38880561696420346,
        0.3825633586212551,
        0.3765591697456307,
        0.37084990575877985,
        0.36549687096126326,
        0.3605488778901333,
        0.35604156933099623,
        0.35199931484501784,
        0.3484289815396873,
        0.3453235626315405,
        0.3426618468333424,
        0.3404188686911006,
        0.33856779819370075,
        0.3370688028461644,
        0.33584844498097516,
        0.33479852558496825,
        0.33379518800159685,
        0.3327175566115788,
        0.33147515622870855,
        0.3299997285459442,
        0.32825296829563777,
        0.32621988140347813,
        0.32389852563388716,
        0.32130556061023857,
        0.3184796289293994,
        0.3154385115362514,
        0.3122018734435383,
        0.3088031826159432,
        0.30525782614135155,
        0.3015720117852735,
        0.2977595161908413,
        0.29382342703792513,
        0.28978665041458057,
        0.2856573790425177,
        0.281440833016188,
        0.27715859521860836,
        0.2728376663694474,
        0.26849704908218736,
        0.2641489640767469,
        0.2598137727418851,
        0.25551710875381856,
        0.2512763338762371,
        0.24710643652565267,
        0.24302111297308787,
        0.2390384697902293,
        0.23517409502892891,
        0.23144438208705234,
        0.2278660517624246,
        0.2244552915163155,
        0.2212317696515271,
        0.2182199060462277,
        0.2154400333170463,
        0.2129137736634384,
        0.21066708583264754,
        0.20870809858000858,
        0.20703223793676756,
        0.20562881275557585,
        0.20446909839137334,
        0.2034948585641235,
        0.20262377076407384,
        0.20174195643076998,
        0.20075902409346363,
        0.19956035725908966,
        0.19817783005803138,
        0.19652707422640528,
        0.19464608512464157,
        0.1924428852002709,
        0.1899025845849093,
        0.1869777706498652,
    ],
    &[
        0.6869777706498652,
        0.6836707191684516,
        0.6799941962706126,
        0.6759654001065564,
        0.6716173291175533,
        0.6669885388150756,
        0.6621127746941223,
        0.6570263898951888,
        0.6517620602803672,
        0.6463460978330817,
        0.6408025455639642,
        0.6351553481411127,
        0.6294300359413804,
        0.6236408403723279,
        0.6178042195069069,
        0.6119409570590723,
        0.6060599442461618,
        0.6001618005064294,
        0.5942522783100267,
        0.5883033137453488,
        0.5822961569276482,
        0.5761898592381783,
        0.5699263037206472,
        0.5634450550672653,
        0.5566895971592981,
        0.5495901479197447,
        0.5421076216506493,
        0.534210021753847,
        0.5258980306955128,
        0.5172340084890106,
        0.5083308774902906,
        0.4993530706947696,
        0.4904944878965089,
        0.4819459903076008,
        0.47386487945902017,
        0.46635350049238533,
        0.4594570234327075,
        0.45317885351496906,
        0.4474967608477293,
        0.4423738034266793,
        0.43776863653991305,
        0.4336416877639836,
        0.42994667471360093,
        0.42660891156709446,
        0.4235259665762444,
        0.42058865966242526,
        0.4176824171413326,
        0.4146908016472692,
        0.41153161469368427,
        0.40815854559226555,
        0.40454026432180956,
        0.40067294789382957,
        0.39658536019503166,
        0.3923262854661078,
        0.387924716469156,
        0.3834366060832667,
        0.37893103958337,
        0.37438587265638146,
        0.36985650822657634,
        0.36535253484982805,
        0.36082491117366666,
        0.3563079494490439,
        0.35176553611491007,
        0.3471538909519691,
        0.3425404570789283,
        0.33782382099346037,
        0.33305025260130733,
        0.32825990855946374,
        0.3234239998333999,
        0.3185584560881132,
        0.3137247945430051,
        0.30895892350133225,
        0.3042459163845164,
        0.29959767357134653,
        0.2951145450183302,
        0.2907851125273716,
        0.2865864074158319,
        0.28261519280539366,
        0.27888139136626006,
        0.2753586219218191,
        0.27210453505126364,
        0.26917695170804223,
        0.2665434636646343,
        0.26420514729547134,
        0.2622661120585795,
        0.2606351513248621,
        0.2592625118256235,
        0.25805072219758546,
        0.2570021695431159,
        0.25602978367679763,
        0.2550632483664064,
        0.25413686781235545,
        0.25316197624892006,
        0.2520765271877765,
        0.2508601172536886,
        0.24941495706625094,
        0.2476793514985231,
        0.24554622419599773,
        0.24314249317184672,
        0.2404375239115756,
        0.23740065061202476,
    ],
    &[
        0.7374006506120248,
        0.7341039275474407,
        0.7306046955884516,
        0.7268453317790788,
        0.7228897018374703,
        0.7188087361379124,
        0.7145587494447991,
        0.7101767654369358,
        0.7057258382691778,
        0.701202500647571,
        0.6966014840088757,
        0.6919487865944052,
        0.6873030147774218,
        0.6826685953547922,
        0.6780133875041734,
        0.673405879752434,
        0.6688761759742986,
        0.6643576710079298,
        0.6599252595110335,
        0.6555549133328571,
        0.6512344354266759,
        0.6469900185426934,
        0.6427905242681873,
        0.6386273277750136,
        0.6345439632554183,
        0.6305014453723825,
        0.6265316875766039,
        0.6226747553585059,
        0.6189501370901096,
        0.6154116877583067,
        0.6121054020911446,
        0.6090648393595116,
        0.6063070007657961,
        0.6038126625842589,
        0.6015187976831249,
        0.5993255774676491,
        0.5971135263065719,
        0.5947490196955114,
        0.5921021502225341,
        0.5890737687605387,
        0.5855967917120518,
        0.5816182971325539,
        0.5770938089339459,
        0.5719904661030882,
        0.5662801966061333,
        0.5599318723145591,
        0.5529265981631972,
        0.5452727005525777,
        0.5370087669685724,
        0.5282054301797524,
        0.5189710917888511,
        0.5094593708079871,
        0.49986562313215555,
        0.4903785763661501,
        0.48115421510778056,
        0.47232558712154965,
        0.46396216263884293,
        0.45605782165839,
        0.4485878299614965,
        0.4415028583892456,
        0.43471968654846466,
        0.4281663892651897,
        0.42177956279142415,
        0.4154847458268956,
        0.4092504883204555,
        0.4030326293282059,
        0.396810048673362,
        0.3905955775903632,
        0.3844035786218408,
        0.37825290372930953,
        0.3721842473692194,
        0.36623966511503214,
        0.3604468025289498,
        0.35484367044344167,
        0.3494748921936146,
        0.34437401404831763,
        0.3395764009522167,
        0.3351169181724766,
        0.3310305328492261,
        0.32733060061006164,
        0.32403669701038945,
        0.32114787151540614,
        0.31864125536077736,
        0.31648419612950746,
        0.314636641083298,
        0.3130690485772604,
        0.3117617174957761,
        0.3106760047794398,
        0.3097386643850398,
        0.3088366402378609,
        0.3078644867816931,
        0.30672845598723136,
        0.3053720606138745,
        0.3037632246002781,
        0.30188405308288263,
        0.29972191596000874,
        0.29728722355705783,
        0.2946017874368208,
        0.29167538780289703,
        0.2885301592788078,
        0.28519780949185547,
    ],
    &[
        0.7851978094918555,
        0.7816896009672823,
        0.7780244160321275,
        0.7742311116841694,
        0.7703250790511859,
        0.7663156880271342,
        0.7622272105327605,
        0.7580733433101782,
        0.7538632551182088,
        0.7496115242830006,
        0.7453385650240242,
        0.7410599345685976,
        0.7367852982108006,
        0.7325299815960475,
        0.7283162202915043,
        0.7241639988205579,
        0.720082559457635,
        0.7160915510603794,
        0.7122186261222008,
        0.7084707392030647,
        0.704864790448903,
        0.7014194259577186,
        0.6981508705756688,
        0.6950777421456344,
        0.6922216522308405,
        0.6895984000863827,
        0.6872295069095637,
        0.685131444855479,
        0.6833098874598567,
        0.6817645072520333,
        0.6804730589372183,
        0.6793907466223091,
        0.6784451306149331,
        0.6775324760743879,
        0.6765277983764235,
        0.6753188797004098,
        0.6738286618190429,
        0.6720164605246334,
        0.669853778605029,
        0.6673093874574015,
        0.6643557724579897,
        0.6609647002652357,
        0.657125780874119,
        0.6528500647595183,
        0.6481599267914243,
        0.6430853621442203,
        0.637662291383716,
        0.6319426055122719,
        0.6259723479843378,
        0.6198001970233852,
        0.6134828383142934,
        0.6070743423720067,
        0.6006058815479335,
        0.5941046667864127,
        0.5875893657305638,
        0.5810414726588148,
        0.5744239405673711,
        0.5677044546064961,
        0.5608198195679956,
        0.5536891442225345,
        0.546253947248188,
        0.5384555250647418,
        0.5302310564937289,
        0.5215682211395296,
        0.512512391068533,
        0.5031293567313523,
        0.49354177510916547,
        0.48391674433786735,
        0.4744056589890994,
        0.46513979468414124,
        0.45623104321124364,
        0.4477556433289764,
        0.4397604393078469,
        0.43227414369872935,
        0.4253179914680459,
        0.41891070425299237,
        0.41306691411098095,
        0.4077871556171558,
        0.4030586062766904,
        0.39886395994018714,
        0.3951792446041549,
        0.391969977795025,
        0.3891930176084846,
        0.3867938032258543,
        0.3846885756461407,
        0.38276012931531267,
        0.3808873095572029,
        0.3789647370973097,
        0.37689744327203095,
        0.37462219957618903,
        0.37212238353915517,
        0.3693875723723137,
        0.3664221310607376,
        0.3632675118014358,
        0.35993705959048616,
        0.3564374221658279,
        0.3528117838241201,
        0.3490658363479703,
        0.3451919909756709,
        0.34123172428389165,
        0.3371897626129585,
    ],
    &[
        0.8371897626129586,
        0.8330396370211973,
        0.828839508824685,
        0.824585948021242,
        0.8202480392590493,
        0.815873283261218,
        0.8114729695563612,
        0.8070161016744442,
        0.8025232172209993,
        0.7980409639633469,
        0.7935576311464199,
        0.7890667457271606,
        0.7846142845656349,
        0.7802381559503748,
        0.7759274089507815,
        0.7716893590384517,
        0.7675920614532922,
        0.7636642899435825,
        0.7598813332215092,
        0.7562946648274725,
        0.7529823539375025,
        0.749911848223554,
        0.747090363147531,
        0.7446138229920819,
        0.7424518114501165,
        0.7405580267977154,
        0.7389938203900285,
        0.737747424231135,
        0.7366722970369936,
        0.7357252561431358,
        0.7348336650275046,
        0.7339255398404391,
        0.7329656715975246,
        0.7319247751817355,
        0.7307771936222561,
        0.7294189020218599,
        0.7278399794695106,
        0.725990267121829,
        0.7237758253296892,
        0.7211710372063659,
        0.718257881370149,
        0.71502984906685,
        0.7114621816557595,
        0.7076046699134908,
        0.7035342460271405,
        0.6992281087033088,
        0.6946987738563711,
        0.6900124910641406,
        0.6852276668294034,
        0.6803205641104954,
        0.6753322253305994,
        0.6703377778082283,
        0.6653600353351599,
        0.660368477135307,
        0.6554240979611913,
        0.6505593362812774,
        0.6457096626558673,
        0.6408796834997499,
        0.6360966310078401,
        0.6312906161366371,
        0.62643653293395,
        0.6215742728814437,
        0.6166513346120949,
        0.6116658781377947,
        0.6066855606053366,
        0.6016834641475597,
        0.5967032382640147,
        0.5917996772919778,
        0.5869633237509524,
        0.5822215263982778,
        0.5776038095577125,
        0.5731020860615784,
        0.568719948470537,
        0.5644578182689641,
        0.5602785720426586,
        0.5561380854809682,
        0.5519844370542958,
        0.5477317295136432,
        0.5432850199247578,
        0.5385701892055211,
        0.5335339322016242,
        0.5281423332465673,
        0.5223805329682681,
        0.5162409105928223,
        0.5097165042488604,
        0.5028183111128788,
        0.4955910067316058,
        0.4881153802583687,
        0.4805046728915646,
        0.47288480705475666,
        0.46536467280561783,
        0.4580363608518835,
        0.4509605871044223,
        0.4441471558550312,
        0.4375887905445971,
        0.4312728290286761,
        0.4251553476378531,
        0.4191858230463643,
        0.4133526661988237,
        0.4076142886055892,
        0.40192988049558,
    ],
    &[
        0.9019298804955799,
        0.8963079256837798,
        0.8907352664003857,
        0.8851882159004726,
        0.8796778788402247,
        0.8742122348396751,
        0.8687716361900614,
        0.8633512498988445,
        0.8579745635745369,
        0.8526324371855227,
        0.8473234908595432,
        0.8420601322319721,
        0.8368946995540475,
        0.8318250756269496,
        0.8268870018627824,
        0.8221133951167929,
        0.8175630500298846,
        0.8132630863592861,
        0.8092365755877217,
        0.8055384580217916,
        0.8022032180902963,
        0.799251651758923,
        0.7966837574273966,
        0.794473627030088,
        0.7926054893828156,
        0.7910012804473278,
        0.7896101671777952,
        0.788411545748358,
        0.7873569064577692,
        0.7864788393766369,
        0.7856455691048743,
        0.7847820323213817,
        0.7837790279040399,
        0.7825504589530565,
        0.7810451368885195,
        0.7792467625869488,
        0.777167675852307,
        0.774791727414129,
        0.7721319218742428,
        0.7692239390923767,
        0.7660901510065947,
        0.7627311091398066,
        0.7591728857421385,
        0.7554522964663449,
        0.7515726961410929,
        0.747544910879953,
        0.743399797069646,
        0.739165743580189,
        0.7348560313201558,
        0.7304852127902298,
        0.7260812832363582,
        0.7216788416292141,
        0.7172890739211983,
        0.7129237756522862,
        0.7086127857581849,
        0.7043768838160248,
        0.7002148416523111,
        0.6961341661327456,
        0.6921437742645469,
        0.6882558861824364,
        0.6844583513882491,
        0.6807732545521267,
        0.677211745925477,
        0.6737942826639343,
        0.6705393532925333,
        0.6674832420114409,
        0.6646592920193007,
        0.6620827595569945,
        0.6597784254452271,
        0.6577594984144526,
        0.6560046657750785,
        0.6544810717312923,
        0.6531386617274526,
        0.6518914608829447,
        0.65063940479239,
        0.6492718029315796,
        0.6476678170836483,
        0.6457222732445154,
        0.6433760450426954,
        0.640594664689718,
        0.6373557614386433,
        0.6336392191956706,
        0.6294456495294223,
        0.6247883046345049,
        0.6196896272135439,
        0.6141815778675772,
        0.6083180717437592,
        0.6021485590197613,
        0.5957153472310401,
        0.5890423995416466,
        0.5821589222686987,
        0.5750741375234976,
        0.5677750956863415,
        0.5602348539420093,
        0.55243931653588,
        0.5443723049635021,
        0.5360025705289008,
        0.5273292546793857,
        0.5183961192144677,
        0.5092606110544149,
        0.5,
    ],
];

const CYCLES: &[&[usize]] = &[&[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]];
